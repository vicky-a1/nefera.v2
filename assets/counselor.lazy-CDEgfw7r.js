import{u as $,l as D,n as G,r as f,j as e,P as R,C,c as A,S as P,e as w,B as x,o as H,p as F,q as _,b as B,s as W,t as Y,v as U}from"./index-iislL19E.js";function O(i){return i.reduce((d,g)=>d+g,0)}function E(i){return new Date(i).toLocaleString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function K(i){return i<=4?{label:"Minimal depression",action:"Monitor; no intervention needed"}:i<=9?{label:"Mild depression",action:"Watchful waiting; lifestyle modifications"}:i<=14?{label:"Moderate depression",action:"Counselor support recommended"}:i<=19?{label:"Moderately severe depression",action:"Counselor + psychiatric evaluation"}:{label:"Severe depression",action:"Urgent psychiatric intervention required"}}function V(i){return i<=4?{label:"Minimal anxiety",action:"No intervention needed"}:i<=9?{label:"Mild anxiety",action:"Monitor; suggest coping strategies"}:i<=14?{label:"Moderate anxiety",action:"Counselor support and interventions"}:{label:"Severe anxiety",action:"Urgent psychiatric evaluation required"}}function J(i){const d=!!i[0],g=!!i[1],v=!!i[2],t=!!i[3],N=!!i[4],p=!!i[5];return!d&&!g&&!v&&!t&&!N&&!p?{level:"None",action:"ðŸŸ¢ Green â€“ Continue monitoring"}:p?{level:"Extreme",action:"ðŸš¨ðŸš¨ðŸš¨ Maximum â€“ Recent attempt/active preparation; emergency intervention"}:N?{level:"High",action:"ðŸš¨ Red/Emergency â€“ Intent + plan; psychiatric hospitalization pathway"}:v||t?{level:"Moderate",action:"ðŸ”´ Red â€“ Active ideation with plan; urgent assessment"}:d||g?{level:"Low",action:"ðŸŸ  Orange â€“ Passive ideation; counsel close follow-up"}:{level:"Low",action:"ðŸŸ  Orange â€“ Passive ideation; counsel close follow-up"}}function Z(){const{state:i,dispatch:d}=$(),g=D(),[v]=G(),t=i.counselor.students,[N,p]=f.useState(v.get("student")??t[0]?.id??""),o=t.find(r=>r.id===N)??t[0],[u,s]=f.useState(o?.phq9?.answers??Array.from({length:9},()=>0)),[c,l]=f.useState(!1),[I,b]=f.useState(!1),T=[{value:"0",label:"0"},{value:"1",label:"1"},{value:"2",label:"2"},{value:"3",label:"3"}],M=["Little interest or pleasure in doing things","Feeling down, depressed, or hopeless","Trouble falling or staying asleep, or sleeping too much","Feeling tired or having little energy","Poor appetite or overeating","Feeling bad about yourself","Trouble concentrating on things","Moving or speaking slowly, or being fidgety/restless","Thoughts of self-harm or that you would be better off dead"],y=O(u),h=K(y),k=(u[8]??0)>=1,S=["Tele-MANAS 14416","KIRAN 1800-599-0019"],n=["Thank you for sharing this. Your feelings matter.","Please reach out to a parent or another trusted adult for support.","If you need immediate help, call a government toll-free helpline."],a=["Try slow breathing (in 1-2-3, out 1-2-3-4).","Try grounding: 3 things you see, 2 you touch, 1 you hear."];function m(){const r=new Date().toISOString();d({type:"counselor/savePhq9",studentId:o?.id??"s_1",answers:u,createdAt:r}),k&&o?.id&&(d({type:"counselor/addSafetyEvent",event:{id:`evt_${r}`,createdAt:r,studentId:o.id,kind:"phq9_q9_positive",shownHelplines:S,shownMessages:n,shownSuggestions:a}}),d({type:"teacher/setStudentFlags",studentId:o.id,flags:"crisis"}),b(!0)),l(!0)}return e.jsxs(R,{emoji:"ðŸ“‹",title:"PHQ-9",subtitle:"Score and save a student questionnaire.",children:[e.jsx(C,{children:e.jsxs(A,{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-xs font-semibold text-[rgb(var(--nefera-muted))]",children:"Student"}),e.jsx("div",{className:"mt-1",children:e.jsx(P,{value:o?.id??"",onChange:r=>{p(r);const j=t.find(q=>q.id===r);s(j?.phq9?.answers??Array.from({length:9},()=>0))},options:t.map(r=>({value:r.id,label:`${r.name} â€¢ ${r.grade}`}))})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(w,{children:["Total: ",y]}),e.jsx(w,{children:h.label}),e.jsx(x,{variant:"secondary",onClick:()=>g("/counselor/dashboard"),children:"Back"})]})]})}),e.jsxs("div",{className:"mt-4 grid gap-3",children:[M.map((r,j)=>e.jsxs("div",{className:"rounded-2xl border border-white/70 bg-white/60 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-[rgb(var(--nefera-ink))]",children:r}),e.jsx("div",{className:"mt-3",children:e.jsx(P,{value:String(u[j]??0),onChange:q=>s(z=>z.map((L,Q)=>Q===j?Number(q):L)),options:T})})]},r)),e.jsx("div",{className:"hidden justify-end md:flex",children:e.jsx(x,{onClick:m,children:"Save PHQ-9"})})]}),e.jsx("div",{className:"fixed inset-x-0 bottom-[88px] z-40 md:hidden",children:e.jsx("div",{className:"mx-auto w-full max-w-6xl px-4",children:e.jsx("div",{className:"rounded-2xl border border-white/70 bg-white/70 p-3 shadow-lg shadow-black/10 backdrop-blur",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx(x,{className:"min-w-40",onClick:m,children:"Save PHQ-9"})})})})}),e.jsx(F,{open:c,message:"Saved PHQ-9.",onClose:()=>l(!1)}),e.jsx(_,{open:I,onClose:()=>b(!1),title:"Immediate support",description:"A response indicated possible self-harm risk. Show helplines and administer C-SSRS within 1 hour.",footer:e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"secondary",onClick:()=>g(`/counselor/assessments/cssrs?student=${encodeURIComponent(o?.id??"")}`),children:"Open C-SSRS"}),e.jsx(x,{onClick:()=>b(!1),children:"Done"})]}),children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-2xl border border-white/70 bg-white/70 p-4 text-sm text-[rgb(var(--nefera-muted))] whitespace-pre-wrap",children:n.join(`
`)}),e.jsxs("div",{className:"rounded-2xl border border-white/70 bg-white/70 p-4 text-sm text-[rgb(var(--nefera-muted))]",children:[e.jsx("div",{className:"text-sm font-extrabold text-[rgb(var(--nefera-ink))]",children:"Government toll-free helplines"}),e.jsx("div",{className:"mt-2 grid gap-1",children:S.map(r=>e.jsx("div",{className:"text-sm font-semibold text-[rgb(var(--nefera-ink))]",children:r},r))})]}),e.jsx("div",{className:"rounded-2xl border border-white/70 bg-white/70 p-4 text-sm text-[rgb(var(--nefera-muted))] whitespace-pre-wrap",children:a.join(`
`)})]})})]})}function ee(){const{state:i,dispatch:d}=$(),g=D(),[v]=G(),t=i.counselor.students,[N,p]=f.useState(v.get("student")??t[0]?.id??""),o=t.find(h=>h.id===N)??t[0],[u,s]=f.useState(o?.gad7?.answers??Array.from({length:7},()=>0)),[c,l]=f.useState(!1),I=[{value:"0",label:"0"},{value:"1",label:"1"},{value:"2",label:"2"},{value:"3",label:"3"}],b=["Feeling nervous, anxious, or on edge","Not being able to stop or control worrying","Worrying too much about different things","Trouble relaxing","Being so restless that it is hard to sit still","Becoming easily annoyed or irritable","Feeling afraid as if something awful might happen"],T=O(u),M=V(T);function y(){const h=new Date().toISOString();d({type:"counselor/saveGad7",studentId:o?.id??"s_1",answers:u,createdAt:h}),l(!0)}return e.jsxs(R,{emoji:"ðŸ§­",title:"GAD-7",subtitle:"Score and save a student questionnaire.",children:[e.jsx(C,{children:e.jsxs(A,{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-xs font-semibold text-[rgb(var(--nefera-muted))]",children:"Student"}),e.jsx("div",{className:"mt-1",children:e.jsx(P,{value:o?.id??"",onChange:h=>{p(h);const k=t.find(S=>S.id===h);s(k?.gad7?.answers??Array.from({length:7},()=>0))},options:t.map(h=>({value:h.id,label:`${h.name} â€¢ ${h.grade}`}))})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(w,{children:["Total: ",T]}),e.jsx(w,{children:M.label}),e.jsx(x,{variant:"secondary",onClick:()=>g("/counselor/dashboard"),children:"Back"})]})]})}),e.jsxs("div",{className:"mt-4 grid gap-3",children:[b.map((h,k)=>e.jsxs("div",{className:"rounded-2xl border border-white/70 bg-white/60 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-[rgb(var(--nefera-ink))]",children:h}),e.jsx("div",{className:"mt-3",children:e.jsx(P,{value:String(u[k]??0),onChange:S=>s(n=>n.map((a,m)=>m===k?Number(S):a)),options:I})})]},h)),e.jsx("div",{className:"hidden justify-end md:flex",children:e.jsx(x,{onClick:y,children:"Save GAD-7"})})]}),e.jsx("div",{className:"fixed inset-x-0 bottom-[88px] z-40 md:hidden",children:e.jsx("div",{className:"mx-auto w-full max-w-6xl px-4",children:e.jsx("div",{className:"rounded-2xl border border-white/70 bg-white/70 p-3 shadow-lg shadow-black/10 backdrop-blur",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx(x,{className:"min-w-40",onClick:y,children:"Save GAD-7"})})})})}),e.jsx(F,{open:c,message:"Saved GAD-7.",onClose:()=>l(!1)})]})}function se(){const{state:i,dispatch:d}=$(),g=D(),[v]=G(),t=i.counselor.students,[N,p]=f.useState(v.get("student")??t[0]?.id??""),o=t.find(a=>a.id===N)??t[0],[u,s]=f.useState(o?.cssrs?.answers??Array.from({length:6},()=>!1)),[c,l]=f.useState(!1),[I,b]=f.useState(!1),T=["Wish to be dead","Non-specific active thoughts of suicide","Active thoughts with any methods","Active thoughts with some intent","Active thoughts with intent and plan","Suicidal behavior"],M=u.filter(Boolean).length,y=J(u),h=["Tele-MANAS 14416","KIRAN 1800-599-0019"],k=["Thank you for recording this screening.","Please follow your schoolâ€™s safety protocol and connect the student with a trusted adult.","If there is immediate danger, use emergency services."],S=["Calming breath (in 1-2-3, out 1-2-3-4).","Grounding: 3 things you see, 2 you touch, 1 you hear."];function n(){const a=new Date().toISOString();if(d({type:"counselor/saveCssrs",studentId:o?.id??"s_1",answers:u,createdAt:a}),M>0&&o?.id){d({type:"counselor/addSafetyEvent",event:{id:`evt_${a}`,createdAt:a,studentId:o.id,kind:"cssrs_positive",shownHelplines:h,shownMessages:k,shownSuggestions:S}});const m=y.level==="Extreme"||y.level==="High"?"crisis":y.level==="Moderate"?"red":"orange";d({type:"teacher/setStudentFlags",studentId:o.id,flags:m}),b(!0)}l(!0)}return e.jsxs(R,{emoji:"ðŸ›Ÿ",title:"C-SSRS",subtitle:"Record and save suicide risk screening responses.",children:[e.jsx(C,{children:e.jsxs(A,{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-xs font-semibold text-[rgb(var(--nefera-muted))]",children:"Student"}),e.jsx("div",{className:"mt-1",children:e.jsx(P,{value:o?.id??"",onChange:a=>{p(a);const m=t.find(r=>r.id===a);s(m?.cssrs?.answers??Array.from({length:6},()=>!1))},options:t.map(a=>({value:a.id,label:`${a.name} â€¢ ${a.grade}`}))})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(w,{children:[M," positive"]}),e.jsx(w,{children:y.action}),e.jsx(x,{variant:"secondary",onClick:()=>g("/counselor/dashboard"),children:"Back"})]})]})}),e.jsxs("div",{className:"mt-4 grid gap-2",children:[T.map((a,m)=>e.jsxs("button",{type:"button",onClick:()=>s(r=>r.map((j,q)=>q===m?!j:j)),className:H("flex items-center justify-between gap-3 rounded-2xl border border-white/70 bg-white/60 p-4 text-left shadow-lg shadow-black/5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:bg-white/80 hover:shadow-xl active:translate-y-0",u[m]?"ring-4 ring-[rgba(244,63,94,0.14)]":""),children:[e.jsx("div",{className:"min-w-0",children:e.jsx("div",{className:"text-sm font-semibold text-[rgb(var(--nefera-ink))]",children:a})}),e.jsx(w,{tone:u[m]?"danger":"neutral",children:u[m]?"Yes":"No"})]},a)),e.jsx("div",{className:"hidden justify-end md:flex",children:e.jsx(x,{onClick:n,children:"Save C-SSRS"})})]}),e.jsx("div",{className:"fixed inset-x-0 bottom-[88px] z-40 md:hidden",children:e.jsx("div",{className:"mx-auto w-full max-w-6xl px-4",children:e.jsx("div",{className:"rounded-2xl border border-white/70 bg-white/70 p-3 shadow-lg shadow-black/10 backdrop-blur",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx(x,{className:"min-w-40",onClick:n,children:"Save C-SSRS"})})})})}),e.jsx(F,{open:c,message:"Saved C-SSRS.",onClose:()=>l(!1)}),e.jsx(_,{open:I,onClose:()=>b(!1),title:"Support and safety",description:"Show helplines and document what was displayed.",footer:e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"secondary",onClick:()=>g("/counselor/flags"),children:"View flags"}),e.jsx(x,{onClick:()=>b(!1),children:"Done"})]}),children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-2xl border border-white/70 bg-white/70 p-4 text-sm text-[rgb(var(--nefera-muted))] whitespace-pre-wrap",children:k.join(`
`)}),e.jsxs("div",{className:"rounded-2xl border border-white/70 bg-white/70 p-4 text-sm text-[rgb(var(--nefera-muted))]",children:[e.jsx("div",{className:"text-sm font-extrabold text-[rgb(var(--nefera-ink))]",children:"Government toll-free helplines"}),e.jsx("div",{className:"mt-2 grid gap-1",children:h.map(a=>e.jsx("div",{className:"text-sm font-semibold text-[rgb(var(--nefera-ink))]",children:a},a))})]}),e.jsx("div",{className:"rounded-2xl border border-white/70 bg-white/70 p-4 text-sm text-[rgb(var(--nefera-muted))] whitespace-pre-wrap",children:S.join(`
`)})]})})]})}function te(){const{state:i,dispatch:d}=$(),g=W(),v=D(),t=i.counselor.students.find(n=>n.id===g.id),[N,p]=f.useState(!1),[o,u]=f.useState(t?.phq9?.answers??Array.from({length:9},()=>0)),[s,c]=f.useState(t?.gad7?.answers??Array.from({length:7},()=>0)),[l,I]=f.useState(t?.cssrs?.answers??Array.from({length:6},()=>!1));if(!t)return e.jsx(R,{emoji:"ðŸ§‘â€ðŸŽ“",title:"Student",subtitle:"Not found.",children:e.jsx(C,{children:e.jsxs(A,{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-sm text-[rgb(var(--nefera-muted))]",children:"Student not found."}),e.jsx(x,{variant:"secondary",onClick:()=>v("/counselor/flags",{replace:!0}),children:"Back"})]})})});const b=t.id;function T(){const n=new Date().toISOString();d({type:"counselor/savePhq9",studentId:b,answers:o,createdAt:n}),d({type:"counselor/saveGad7",studentId:b,answers:s,createdAt:n}),d({type:"counselor/saveCssrs",studentId:b,answers:l,createdAt:n}),p(!0)}const M=[{value:"0",label:"0"},{value:"1",label:"1"},{value:"2",label:"2"},{value:"3",label:"3"}],y=["Little interest or pleasure in doing things","Feeling down, depressed, or hopeless","Trouble falling or staying asleep, or sleeping too much","Feeling tired or having little energy","Poor appetite or overeating","Feeling bad about yourself","Trouble concentrating on things","Moving or speaking slowly, or being fidgety/restless","Thoughts of self-harm or that you would be better off dead"],h=["Feeling nervous, anxious, or on edge","Not being able to stop or control worrying","Worrying too much about different things","Trouble relaxing","Being so restless that it is hard to sit still","Becoming easily annoyed or irritable","Feeling afraid as if something awful might happen"],k=["Wish to be dead","Non-specific active thoughts of suicide","Active thoughts with any methods","Active thoughts with some intent","Active thoughts with intent and plan","Suicidal behavior"],S=i.counselor.teacherObservations.filter(n=>n.studentId===b);return e.jsxs(R,{emoji:"ðŸ§‘â€ðŸŽ“",title:t.name,subtitle:"Questionnaires and follow-up planning.",children:[e.jsx(C,{children:e.jsxs(A,{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-xs font-semibold text-[rgb(var(--nefera-muted))]",children:"Grade"}),e.jsx("div",{className:"text-sm font-extrabold text-[rgb(var(--nefera-ink))]",children:t.grade})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(w,{tone:U(t.flags),children:Y(t.flags)}),e.jsx(P,{value:t.flags,onChange:n=>d({type:"teacher/setStudentFlags",studentId:t.id,flags:n}),options:[{value:"none",label:"None"},{value:"orange",label:"Watch"},{value:"red",label:"High"},{value:"crisis",label:"Crisis"}]}),e.jsx(x,{variant:"secondary",onClick:()=>v("/counselor/flags"),children:"Back"})]})]})}),e.jsxs("div",{className:"mt-4 grid gap-4",children:[e.jsxs(C,{children:[e.jsx(B,{emoji:"ðŸ§‘â€ðŸ«",title:"Teacher observations",subtitle:"Recent checklists to inform follow-up."}),e.jsxs(A,{className:"grid gap-2",children:[S.slice(0,6).map(n=>e.jsxs("div",{className:"rounded-2xl border border-white/70 bg-white/60 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm font-extrabold tracking-tight text-[rgb(var(--nefera-ink))]",children:E(n.createdAt)}),e.jsxs("div",{className:"mt-1 text-xs font-semibold text-[rgb(var(--nefera-muted))]",children:[n.items.length," item",n.items.length===1?"":"s"]})]}),n.items.length>0?e.jsx(w,{tone:"warn",children:"Observation"}):e.jsx(w,{tone:"neutral",children:"Info"})]}),n.items.length>0?e.jsx("div",{className:"mt-2 text-sm text-[rgb(var(--nefera-muted))] whitespace-pre-wrap",children:n.items.join(`
`)}):null]},n.id)),S.length===0?e.jsx("div",{className:"rounded-2xl border border-white/70 bg-white/60 p-4 text-sm text-[rgb(var(--nefera-muted))]",children:"No teacher observations saved for this student yet."}):null]})]}),e.jsxs(C,{children:[e.jsx(B,{emoji:"ðŸ“‹",title:"PHQ-9",subtitle:`Total: ${O(o)}`}),e.jsx(A,{className:"grid gap-3",children:y.map((n,a)=>e.jsxs("div",{className:"rounded-2xl border border-white/70 bg-white/60 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-[rgb(var(--nefera-ink))]",children:n}),e.jsx("div",{className:"mt-3",children:e.jsx(P,{value:String(o[a]??0),onChange:m=>u(r=>r.map((j,q)=>q===a?Number(m):j)),options:M})})]},n))})]}),e.jsxs(C,{children:[e.jsx(B,{emoji:"ðŸ§­",title:"GAD-7",subtitle:`Total: ${O(s)}`}),e.jsx(A,{className:"grid gap-3",children:h.map((n,a)=>e.jsxs("div",{className:"rounded-2xl border border-white/70 bg-white/60 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-[rgb(var(--nefera-ink))]",children:n}),e.jsx("div",{className:"mt-3",children:e.jsx(P,{value:String(s[a]??0),onChange:m=>c(r=>r.map((j,q)=>q===a?Number(m):j)),options:M})})]},n))})]}),e.jsxs(C,{children:[e.jsx(B,{emoji:"ðŸ›Ÿ",title:"C-SSRS",subtitle:`${l.filter(Boolean).length} positive response${l.filter(Boolean).length===1?"":"s"}`}),e.jsx(A,{className:"grid gap-2",children:k.map((n,a)=>e.jsxs("button",{type:"button",onClick:()=>I(m=>m.map((r,j)=>j===a?!r:r)),className:H("flex items-center justify-between gap-3 rounded-2xl border border-white/70 bg-white/60 p-4 text-left shadow-lg shadow-black/5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:bg-white/80 hover:shadow-xl active:translate-y-0",l[a]?"ring-4 ring-[rgba(244,63,94,0.14)]":""),children:[e.jsx("div",{className:"min-w-0",children:e.jsx("div",{className:"text-sm font-semibold text-[rgb(var(--nefera-ink))]",children:n})}),e.jsx(w,{tone:l[a]?"danger":"neutral",children:l[a]?"Yes":"No"})]},n))})]}),e.jsx("div",{className:"hidden justify-end md:flex",children:e.jsx(x,{onClick:T,children:"Save questionnaires"})})]}),e.jsx("div",{className:"fixed inset-x-0 bottom-[88px] z-40 md:hidden",children:e.jsx("div",{className:"mx-auto w-full max-w-6xl px-4",children:e.jsx("div",{className:"rounded-2xl border border-white/70 bg-white/70 p-3 shadow-lg shadow-black/10 backdrop-blur",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx(x,{className:"min-w-40",onClick:T,children:"Save questionnaires"})})})})}),e.jsx(F,{open:N,message:"Saved questionnaires.",onClose:()=>p(!1)})]})}function ne(){const{state:i,dispatch:d}=$(),g=D(),v=i.counselor.reports,t=v.reduce((s,c)=>{const l=Date.parse(c.createdAt);return Number.isNaN(l)?s:Math.max(s,l)},0),N=1e3*60*60*24*7,p={};for(const s of v){const c=s.context?.classId;if(!c)continue;const l=Date.parse(s.createdAt);Number.isNaN(l)||t-l>N||(p[c]=(p[c]??0)+1)}function o(s){const c=/(self-harm|suicide|weapon|assault)/i.test(s.type)||/(immediate danger|kill|die|hurt myself)/i.test(s.description),l=s.context?.classId,I=l?(p[l]??0)>=3:!1;return c||I}const u=[...v].sort((s,c)=>{const l=Number(o(c))-Number(o(s));return l!==0?l:Date.parse(c.createdAt)-Date.parse(s.createdAt)});return e.jsx(R,{emoji:"ðŸ§¾",title:"Reports",subtitle:"Safety and wellbeing reports.",children:e.jsxs("div",{className:"grid gap-3",children:[u.map(s=>e.jsx(C,{children:e.jsxs(A,{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsx("div",{className:"text-base font-extrabold tracking-tight text-[rgb(var(--nefera-ink))]",children:s.type}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o(s)?e.jsx(w,{tone:"danger",children:"High priority"}):null,e.jsx(w,{tone:s.status==="resolved"?"ok":s.status==="reviewing"?"warn":"neutral",children:s.status})]})]}),e.jsx("div",{className:"text-xs font-semibold text-[rgb(var(--nefera-muted))]",children:E(s.createdAt)}),e.jsxs("div",{className:"text-xs font-semibold text-[rgb(var(--nefera-muted))]",children:[s.context?.school?`School: ${s.context.school}`:null,s.context?.className?`${s.context?.school?" â€¢ ":""}Class: ${s.context.className}`:null,s.context?.submittedBy?`${s.context?.school||s.context?.className?" â€¢ ":""}Submitted by: ${s.context.submittedBy}`:null]}),e.jsx("div",{className:"text-sm leading-6 text-[rgb(var(--nefera-muted))] whitespace-pre-wrap",children:s.description}),e.jsxs("div",{className:"text-xs font-semibold text-[rgb(var(--nefera-muted))]",children:["Anonymous: ",s.anonymous?"Yes":"No"]}),!s.anonymous&&s.context?.studentName?e.jsxs("div",{className:"text-xs font-semibold text-[rgb(var(--nefera-muted))]",children:["Student: ",s.context.studentName]}):null,e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 pt-1",children:[e.jsx("div",{className:"min-w-56",children:e.jsx(P,{value:s.status,onChange:c=>d({type:"reports/setStatus",reportId:s.id,status:c}),options:[{value:"received",label:"received"},{value:"reviewing",label:"reviewing"},{value:"resolved",label:"resolved"}]})}),e.jsx(x,{size:"sm",variant:"secondary",onClick:()=>d({type:"reports/setStatus",reportId:s.id,status:s.status==="resolved"?"reviewing":"resolved"}),children:s.status==="resolved"?"Re-open":"Mark resolved"})]})]})},s.id)),v.length===0?e.jsxs(C,{children:[e.jsx(B,{emoji:"ðŸŒ¿",title:"No reports yet",subtitle:"Reports will appear here as they are submitted."}),e.jsx(A,{className:"text-sm text-[rgb(var(--nefera-muted))]",children:"This page helps counselors review and coordinate follow-up."})]}):null,e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{variant:"secondary",onClick:()=>g("/counselor/dashboard"),children:"Back"})})]})})}export{se as CounselorAssessmentCssrs,ee as CounselorAssessmentGad7,Z as CounselorAssessmentPhq9,ne as CounselorReports,te as CounselorStudentDetail};
